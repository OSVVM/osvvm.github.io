Report.sources['./../../../OsvvmLibraries/VideoBus_LouisAdriaens/src/bmp_pack.vhd'] = '--\n--&nbsp;&nbsp;File&nbsp;Name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_pack.vhd\n--\n--&nbsp;&nbsp;Maintainer:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Louis&nbsp;Adriaens&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email:&nbsp;&nbsp;louisadriaens@outlook.com\n--&nbsp;&nbsp;Contributor(s):\n--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Louis&nbsp;Adriaens&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;louisadriaens@outlook.com\n--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Limor&nbsp;Yonatani\n--\n--\n--&nbsp;&nbsp;Description:\n--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bitmap&nbsp;logger\n--\n--\n--\n--&nbsp;&nbsp;Revision&nbsp;History:\n--&nbsp;&nbsp;&nbsp;&nbsp;Date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Version&nbsp;&nbsp;&nbsp;&nbsp;Description\n--&nbsp;&nbsp;&nbsp;&nbsp;08/2023&nbsp;&nbsp;&nbsp;1.00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initial&nbsp;revision\n--&nbsp;\n&nbsp;\n--&nbsp;HOW&nbsp;TO&nbsp;USE:\n&nbsp;&nbsp;&nbsp;--&nbsp;write_bmp_file_inst:&nbsp;entity&nbsp;work.write_bmp_file\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;generic&nbsp;map&nbsp;(\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&quot;bmp_logs/bmp_frame_&quot;,\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_num_of_frames&nbsp;=&gt;&nbsp;20,\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_picwidth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&lt;WIDTH&gt;,\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g_picheight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&lt;HEIGHT&gt;,\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUM_DATA_STREAMS&nbsp;=&gt;&nbsp;1&nbsp;\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;)\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;port&nbsp;map&nbsp;(\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_vsync&nbsp;&nbsp;&nbsp;=&gt;&nbsp;vid_fval_out,\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_hsync&nbsp;&nbsp;&nbsp;=&gt;&nbsp;vid_lval_out,\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_clk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;Clk,\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_data_en&nbsp;=&gt;&nbsp;vid_dval_out,\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_data(0)&nbsp;=&gt;&nbsp;vid_data_out\n&nbsp;&nbsp;&nbsp;--&nbsp;&nbsp;);\n&nbsp;\n--------------------------------------------------------------------------------\n&nbsp;\n&nbsp;\n--------------------------------------------------------------------------------\n--&nbsp;Library&nbsp;declaration\n--------------------------------------------------------------------------------\nlibrary&nbsp;ieee;\n&nbsp;&nbsp;&nbsp;use&nbsp;ieee.std_logic_1164.all;\n&nbsp;&nbsp;&nbsp;use&nbsp;ieee.numeric_std.all;\n&nbsp;\npackage&nbsp;bmplibpack&nbsp;is\n&nbsp;\n--------------------------------------------------------------------------------\n----&nbsp;Pack.&nbsp;Procedure&nbsp;&amp;amp;&nbsp;Function&nbsp;declaration\n--------------------------------------------------------------------------------\n&nbsp;\n&nbsp;&nbsp;&nbsp;--&nbsp;subtype&nbsp;definition\n&nbsp;&nbsp;&nbsp;subtype&nbsp;T_BYTE&nbsp;&nbsp;is&nbsp;std_logic_vector(07&nbsp;downto&nbsp;00);\n&nbsp;&nbsp;&nbsp;subtype&nbsp;T_WORD&nbsp;&nbsp;is&nbsp;std_logic_vector(15&nbsp;downto&nbsp;00);\n&nbsp;&nbsp;&nbsp;subtype&nbsp;T_DWORD&nbsp;is&nbsp;std_logic_vector(31&nbsp;downto&nbsp;00);\n&nbsp;&nbsp;&nbsp;subtype&nbsp;T_3BYTE&nbsp;is&nbsp;std_logic_vector(23&nbsp;downto&nbsp;00);\n&nbsp;\n&nbsp;&nbsp;&nbsp;type&nbsp;T_PICFILE&nbsp;is&nbsp;file&nbsp;of&nbsp;character;\n&nbsp;\n&nbsp;&nbsp;&nbsp;subtype&nbsp;T_PIXEL&nbsp;is&nbsp;T_3BYTE;\n&nbsp;&nbsp;&nbsp;type&nbsp;T_PIXELSARRAY&nbsp;is&nbsp;array&nbsp;(natural&nbsp;range&nbsp;&lt;&gt;)&nbsp;of&nbsp;T_PIXEL;\n&nbsp;&nbsp;&nbsp;type&nbsp;T_picdata&nbsp;is&nbsp;access&nbsp;T_PIXELSARRAY;\n&nbsp;\n&nbsp;&nbsp;&nbsp;type&nbsp;R_bmp&nbsp;is&nbsp;record\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;signature&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_WORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;natural;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rsv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;offset&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;headsize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;picwidth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;natural;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;picheight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;natural;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;picplan&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_WORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitcount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_WORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comperssion&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;picsize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;natural;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hpix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vpix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;picdata&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_picdata;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--CurrentSamplePtr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;natural;\n&nbsp;&nbsp;&nbsp;end&nbsp;record;\n&nbsp;\n&nbsp;&nbsp;&nbsp;--type&nbsp;T_PicHandle&nbsp;is&nbsp;access&nbsp;R_bmp;\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;--&nbsp;constant&nbsp;chunck&nbsp;ID&nbsp;for&nbsp;PCM&nbsp;uncompressed&nbsp;files\n&nbsp;&nbsp;&nbsp;constant&nbsp;C_HEAD_SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_WORD&nbsp;&nbsp;:=&nbsp;X&quot;4d42&quot;;\n&nbsp;&nbsp;&nbsp;constant&nbsp;C_HEAD_RSV&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD&nbsp;:=&nbsp;X&quot;00000000&quot;;\n&nbsp;&nbsp;&nbsp;constant&nbsp;C_HEAD_OFFSET&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD&nbsp;:=&nbsp;X&quot;00000036&quot;;\n&nbsp;&nbsp;&nbsp;constant&nbsp;C_HEAD_SIZE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD&nbsp;:=&nbsp;X&quot;00000028&quot;;\n&nbsp;&nbsp;&nbsp;constant&nbsp;C_HEAD_PLAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_WORD&nbsp;&nbsp;:=&nbsp;X&quot;0001&quot;;\n&nbsp;&nbsp;&nbsp;constant&nbsp;C_BIT_COUNT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_WORD&nbsp;&nbsp;:=&nbsp;X&quot;0018&quot;;&nbsp;--&nbsp;24&nbsp;bits&nbsp;colors\n&nbsp;&nbsp;&nbsp;constant&nbsp;C_COMPRESSION&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD&nbsp;:=&nbsp;X&quot;00000000&quot;;&nbsp;--&nbsp;no&nbsp;compression\n&nbsp;&nbsp;&nbsp;constant&nbsp;C_BMP_WIDTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD&nbsp;:=&nbsp;X&quot;00000000&quot;;\n&nbsp;\n&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;read_byte(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;out&nbsp;T_BYTE);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;read_word(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;out&nbsp;T_WORD);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;read_dword(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;out&nbsp;T_DWORD);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;read_pix(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;out&nbsp;T_3BYTE);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;write_byte(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;in&nbsp;&nbsp;T_BYTE);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;write_word(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;in&nbsp;&nbsp;T_WORD);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;write_dword(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;in&nbsp;&nbsp;T_DWORD);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;write_pix(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;in&nbsp;&nbsp;T_3BYTE);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;write_BmpHeader(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;bmp_record&nbsp;:&nbsp;in&nbsp;R_bmp);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;p_bmp_open(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;file_name&nbsp;&nbsp;:&nbsp;in&nbsp;string;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;bmp_record&nbsp;:&nbsp;out&nbsp;R_bmp);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;p_bmp_read(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;bmp_record&nbsp;:&nbsp;out&nbsp;R_bmp);\n&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;PutPixel(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Sample&nbsp;:&nbsp;in&nbsp;T_3BYTE);\n&nbsp;\n&nbsp;&nbsp;&nbsp;type&nbsp;VideoDataArray&nbsp;is&nbsp;array&nbsp;(natural&nbsp;range&nbsp;&lt;&gt;)&nbsp;of&nbsp;std_logic_vector;\n&nbsp;\n&nbsp;&nbsp;&nbsp;component&nbsp;write_bmp_file\ngeneric(\n&nbsp;&nbsp;&nbsp;output_file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;string&nbsp;&nbsp;:=&nbsp;&quot;results/result_&quot;;\n&nbsp;&nbsp;&nbsp;g_num_of_frames&nbsp;&nbsp;&nbsp;:&nbsp;integer&nbsp;:=&nbsp;4;\n&nbsp;&nbsp;&nbsp;g_picwidth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;natural&nbsp;:=&nbsp;64;\n&nbsp;&nbsp;&nbsp;g_pichight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;natural&nbsp;:=&nbsp;64;\n&nbsp;&nbsp;&nbsp;NUM_DATA_STREAMS&nbsp;:&nbsp;natural&nbsp;:=&nbsp;1\n&nbsp;&nbsp;&nbsp;);\nport(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_vsync&nbsp;&nbsp;&nbsp;:&nbsp;in&nbsp;&nbsp;&nbsp;std_logic;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_hsync&nbsp;&nbsp;&nbsp;:&nbsp;in&nbsp;&nbsp;&nbsp;std_logic;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_clk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;in&nbsp;&nbsp;&nbsp;std_logic;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_data_en&nbsp;:&nbsp;in&nbsp;&nbsp;&nbsp;std_logic;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_data&nbsp;&nbsp;:&nbsp;in&nbsp;&nbsp;VideoDataArray(0&nbsp;to&nbsp;NUM_DATA_STREAMS-1)(23&nbsp;downto&nbsp;0)\n&nbsp;&nbsp;&nbsp;);\nend&nbsp;component;\n&nbsp;&nbsp;&nbsp;\nend&nbsp;bmplibpack;\n&nbsp;\n--------------------------------------------------------------------------------\n----&nbsp;Pack.&nbsp;body\n--------------------------------------------------------------------------------\n&nbsp;\npackage&nbsp;body&nbsp;bmplibpack&nbsp;is\n&nbsp;\n--&nbsp;LOW&nbsp;LEVEL&nbsp;FILE&nbsp;ACCESSES&nbsp;---------\n&nbsp;&nbsp;&nbsp;procedure&nbsp;read_byte(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;out&nbsp;T_BYTE)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;c1&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;character;\n&nbsp;&nbsp;&nbsp;&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1&nbsp;:=&nbsp;character&apos;val(0);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;endfile(f)&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;false&nbsp;report&nbsp;&quot;Unexpected&nbsp;end&nbsp;of&nbsp;file&quot;&nbsp;severity&nbsp;failure;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read(f,c1);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value&nbsp;:=&nbsp;std_logic_vector(to_unsigned(natural&apos;val(character&apos;pos(c1)),8));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;read_byte;\n&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;read_word(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;out&nbsp;T_WORD)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;c1,c2&nbsp;:&nbsp;T_BYTE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;w1,w2&nbsp;:&nbsp;T_WORD;\n&nbsp;&nbsp;&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_byte(f,c1);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_byte(f,c2);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w1&nbsp;:=&nbsp;std_logic_vector(resize(unsigned(c1),&nbsp;16));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w2&nbsp;:=&nbsp;std_logic_vector(resize(unsigned(c2),&nbsp;16));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value&nbsp;:=&nbsp;std_logic_vector((shift_left(unsigned(w2),8)&nbsp;+&nbsp;unsigned(w1)));\n&nbsp;&nbsp;&nbsp;end&nbsp;read_word;\n&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;read_dword(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;out&nbsp;T_DWORD)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;w1,w2&nbsp;:&nbsp;T_WORD;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;d1,d2&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_word(f,w1);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_word(f,w2);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1&nbsp;:=&nbsp;std_logic_vector(resize(unsigned(w1),&nbsp;32));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d2&nbsp;:=&nbsp;std_logic_vector(resize(unsigned(w2),&nbsp;32));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value&nbsp;:=&nbsp;std_logic_vector((shift_left(unsigned(d2),16)&nbsp;+&nbsp;unsigned(d1)));\n&nbsp;&nbsp;&nbsp;end&nbsp;read_dword;\n&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;read_pix(&nbsp;&nbsp;--&nbsp;&nbsp;in&nbsp;the&nbsp;RGB&nbsp;scale&nbsp;d1&nbsp;is&nbsp;B&nbsp;d2&nbsp;is&nbsp;G&nbsp;d3&nbsp;is&nbsp;R\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;out&nbsp;T_3BYTE)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;w1,w2,w3&nbsp;:&nbsp;T_BYTE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;d1,d2,d3&nbsp;:&nbsp;T_3BYTE;\n&nbsp;&nbsp;&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_byte(f,w1);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_byte(f,w2);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_byte(f,w3);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1&nbsp;:=&nbsp;std_logic_vector(resize(unsigned(w1),&nbsp;24));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d2&nbsp;:=&nbsp;std_logic_vector(resize(unsigned(w2),&nbsp;24));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d3&nbsp;:=&nbsp;std_logic_vector(resize(unsigned(w3),&nbsp;24));\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Value&nbsp;:=&nbsp;std_logic_vector((shift_left(unsigned(d3),16)&nbsp;+&nbsp;shift_left(unsigned(d2),8)&nbsp;+&nbsp;unsigned(d1)));\n&nbsp;&nbsp;&nbsp;end&nbsp;read_pix;\n&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;write_byte(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;in&nbsp;&nbsp;T_BYTE)&nbsp;is\n&nbsp;&nbsp;&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write(f,character&apos;val(to_integer(unsigned(Value))));\n&nbsp;&nbsp;&nbsp;end&nbsp;write_byte;\n&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;write_word(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;in&nbsp;&nbsp;T_WORD)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;c1,c2&nbsp;:&nbsp;T_BYTE;\n&nbsp;&nbsp;&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1&nbsp;:=&nbsp;Value(07&nbsp;downto&nbsp;00);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_byte(f,c1);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2&nbsp;:=&nbsp;Value(15&nbsp;downto&nbsp;08);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_byte(f,c2);\n&nbsp;&nbsp;&nbsp;end&nbsp;write_word;\n&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;write_dword(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;in&nbsp;&nbsp;T_DWORD)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;d1,d2&nbsp;:&nbsp;T_WORD;\n&nbsp;&nbsp;&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d1&nbsp;:=&nbsp;Value(15&nbsp;downto&nbsp;00);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_word(f,d1);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d2&nbsp;:=&nbsp;Value(31&nbsp;downto&nbsp;16);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_word(f,d2);\n&nbsp;&nbsp;&nbsp;end&nbsp;write_dword;\n&nbsp;\n&nbsp;&nbsp;&nbsp;procedure&nbsp;write_pix(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Value&nbsp;:&nbsp;in&nbsp;&nbsp;T_3BYTE)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;c1,c2,c3&nbsp;:&nbsp;T_BYTE;\n&nbsp;&nbsp;&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c1&nbsp;:=&nbsp;Value(07&nbsp;downto&nbsp;00);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_byte(f,c1);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c2&nbsp;:=&nbsp;Value(15&nbsp;downto&nbsp;08);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_byte(f,c2);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3&nbsp;:=&nbsp;Value(23&nbsp;downto&nbsp;16);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_byte(f,c3);\n&nbsp;&nbsp;&nbsp;end&nbsp;write_pix;\n--&nbsp;/LOW&nbsp;LEVEL&nbsp;FILE&nbsp;ACCESSES&nbsp;----------\n&nbsp;\n&nbsp;\n--&nbsp;HIGH&nbsp;LEVEL&nbsp;&nbsp;--------------------\n&nbsp;\nprocedure&nbsp;p_bmp_read(\n&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;bmp_record&nbsp;:&nbsp;out&nbsp;R_bmp)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;PicHandle&nbsp;&nbsp;&nbsp;:&nbsp;R_bmp;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_tmpDW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_tmpW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_WORD;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_tmpB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_BYTE;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_tmpP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PIXEL;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_cnt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;integer;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;std_logic_vector(31&nbsp;downto&nbsp;0);\nbegin\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Checking&nbsp;&quot;RIFF&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;read_word(f,v_tmpW);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v_tmpW&nbsp;/=&nbsp;C_HEAD_SIGN&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;false&nbsp;report&nbsp;&quot;File&nbsp;format&nbsp;is&nbsp;uncorrect&quot;&nbsp;severity&nbsp;failure;\n&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Reading&nbsp;file&nbsp;size&nbsp;-&nbsp;8\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);\n&nbsp;&nbsp;&nbsp;&nbsp;PicHandle.FileSize&nbsp;:=&nbsp;to_integer(unsigned(v_tmpDW));\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);--&nbsp;rsv\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);--&nbsp;offset\n&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Checking&nbsp;Header&nbsp;size\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v_tmpDW&nbsp;/=&nbsp;C_HEAD_SIZE&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;false&nbsp;report&nbsp;&quot;Header&nbsp;size&nbsp;is&nbsp;not&nbsp;supported&quot;&nbsp;severity&nbsp;failure;\n&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Reading&nbsp;picwidth\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);\n&nbsp;&nbsp;&nbsp;&nbsp;PicHandle.picwidth&nbsp;:=&nbsp;to_integer(unsigned(v_tmpDW));\n&nbsp;&nbsp;&nbsp;&nbsp;v_width&nbsp;:=&nbsp;v_tmpDW;\n&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Reading&nbsp;picheight\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);\n&nbsp;&nbsp;&nbsp;&nbsp;PicHandle.picheight&nbsp;:=&nbsp;to_integer(unsigned(v_tmpDW));\n&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Checking&nbsp;plan\n&nbsp;&nbsp;&nbsp;&nbsp;read_word(f,v_tmpW);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v_tmpW&nbsp;/=&nbsp;C_HEAD_PLAN&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;false&nbsp;report&nbsp;&quot;Header&nbsp;plan&nbsp;is&nbsp;not&nbsp;supported&quot;&nbsp;severity&nbsp;failure;\n&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Checking&nbsp;bit&nbsp;count\n&nbsp;&nbsp;&nbsp;&nbsp;read_word(f,v_tmpW);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v_tmpW&nbsp;/=&nbsp;C_BIT_COUNT&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;false&nbsp;report&nbsp;&quot;Header&nbsp;bit&nbsp;count&nbsp;is&nbsp;not&nbsp;supported&quot;&nbsp;severity&nbsp;failure;\n&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Checking&nbsp;compression\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v_tmpDW&nbsp;/=&nbsp;C_COMPRESSION&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;false&nbsp;report&nbsp;&quot;compression&nbsp;is&nbsp;not&nbsp;supported&quot;&nbsp;severity&nbsp;failure;\n&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Reading&nbsp;pic&nbsp;size\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);\n&nbsp;&nbsp;&nbsp;&nbsp;PicHandle.picsize&nbsp;:=&nbsp;to_integer(unsigned(v_tmpDW));\n&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);--&nbsp;Reading&nbsp;hpix\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);--&nbsp;Reading&nbsp;vpix\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);--&nbsp;Reading&nbsp;color1\n&nbsp;&nbsp;&nbsp;&nbsp;read_dword(f,v_tmpDW);--&nbsp;Reading&nbsp;color2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Now&nbsp;loading&nbsp;Data&nbsp;from&nbsp;file\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;note&nbsp;that&nbsp;when&nbsp;width&nbsp;is&nbsp;not&nbsp;a&nbsp;multiplication&nbsp;of&nbsp;4&nbsp;the&nbsp;*.bmp&nbsp;add&nbsp;extra&nbsp;bytes&nbsp;of&nbsp;Zero&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line!\n&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;added&nbsp;=&nbsp;width&nbsp;mod&nbsp;4\n&nbsp;&nbsp;&nbsp;&nbsp;v_cnt&nbsp;:=&nbsp;0;\n&nbsp;&nbsp;&nbsp;&nbsp;PicHandle.picdata&nbsp;:=&nbsp;new&nbsp;T_PIXELSARRAY(0&nbsp;to&nbsp;(PicHandle.picwidth&nbsp;*&nbsp;PicHandle.picheight)-1);\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;0&nbsp;to&nbsp;PicHandle.picheight&nbsp;-&nbsp;1&nbsp;loop\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;read&nbsp;line\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;0&nbsp;to&nbsp;PicHandle.picwidth&nbsp;-&nbsp;1&nbsp;loop\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_pix(f,v_tmpP);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PicHandle.picdata(v_cnt)&nbsp;:=&nbsp;v_tmpP;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v_cnt&nbsp;:=&nbsp;v_cnt&nbsp;+&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;loop;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;removing&nbsp;the&nbsp;extra&nbsp;bytes&nbsp;in&nbsp;the&nbsp;bmp\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v_width(0)&nbsp;=&nbsp;&apos;1&apos;&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_byte(f,v_tmpB);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;v_width(1)&nbsp;=&nbsp;&apos;1&apos;&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_byte(f,v_tmpB);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read_byte(f,v_tmpB);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;loop;\n&nbsp;&nbsp;&nbsp;&nbsp;bmp_record&nbsp;:=&nbsp;PicHandle;\nend&nbsp;p_bmp_read;\n&nbsp;\n&nbsp;\n&nbsp;\nprocedure&nbsp;p_bmp_open(\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;file_name&nbsp;&nbsp;:&nbsp;in&nbsp;string;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;bmp_record&nbsp;:&nbsp;out&nbsp;R_bmp)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;PicHandle&nbsp;&nbsp;:&nbsp;R_bmp;\n&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;pic_file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;file_status:&nbsp;FILE_OPEN_STATUS;\n&nbsp;&nbsp;&nbsp;&nbsp;\nbegin\n&nbsp;&nbsp;&nbsp;&nbsp;FILE_OPEN(file_status,&nbsp;pic_file,&nbsp;file_name,&nbsp;READ_MODE);&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_status&nbsp;&nbsp;/=&nbsp;OPEN_OK&nbsp;then&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;report&nbsp;&quot;file&nbsp;could&nbsp;not&nbsp;open&nbsp;&nbsp;&quot;&nbsp;&amp;&nbsp;file_name&nbsp;severity&nbsp;failure;\n&nbsp;&nbsp;&nbsp;&nbsp;else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;report&nbsp;&quot;Opening&nbsp;source&nbsp;file&nbsp;&nbsp;&quot;&nbsp;&amp;&nbsp;file_name&nbsp;&nbsp;severity&nbsp;note;\n&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;&nbsp;&nbsp;&nbsp;p_bmp_read(pic_file,PicHandle);\n&nbsp;&nbsp;&nbsp;&nbsp;bmp_record&nbsp;:=&nbsp;PicHandle;\n&nbsp;\nend&nbsp;p_bmp_open;\n&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;\nprocedure&nbsp;write_BmpHeader(\n&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;bmp_record&nbsp;&nbsp;:&nbsp;in&nbsp;R_bmp)&nbsp;is\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_tmpDW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_DWORD;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_tmpW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_WORD;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_tmpB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_BYTE;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;v_tmpP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PIXEL;\nbegin\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpW&nbsp;:=&nbsp;C_HEAD_SIGN;\n&nbsp;&nbsp;&nbsp;&nbsp;write_word(f,&nbsp;v_tmpW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Signature\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;std_logic_vector(to_unsigned(bmp_record.FileSize,&nbsp;32));\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;File&nbsp;size&nbsp;-&nbsp;8\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;C_HEAD_RSV;\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;rsv\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;C_HEAD_OFFSET;\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;offset\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;C_HEAD_SIZE;\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;header&nbsp;size\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;std_logic_vector(to_unsigned(bmp_record.picwidth,&nbsp;32));\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;width\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;std_logic_vector(to_unsigned(bmp_record.picheight,&nbsp;32));\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;hight\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpW&nbsp;:=&nbsp;C_HEAD_PLAN;\n&nbsp;&nbsp;&nbsp;&nbsp;write_word(f,&nbsp;v_tmpW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;plan\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpW&nbsp;:=&nbsp;C_BIT_COUNT;\n&nbsp;&nbsp;&nbsp;&nbsp;write_word(f,&nbsp;v_tmpW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;bit&nbsp;count\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;C_COMPRESSION;\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;compression\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;std_logic_vector(to_unsigned(bmp_record.picsize,&nbsp;32));\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;pic&nbsp;size\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;bmp_record.hpix;\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;hpix\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;bmp_record.vpix;\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;vpix\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;C_HEAD_RSV;\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;color1&nbsp;not&nbsp;in&nbsp;use\n&nbsp;&nbsp;&nbsp;&nbsp;v_tmpDW&nbsp;:=&nbsp;C_HEAD_RSV;\n&nbsp;&nbsp;&nbsp;&nbsp;write_dword(f,&nbsp;v_tmpDW);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;color2&nbsp;not&nbsp;in&nbsp;use\n&nbsp;&nbsp;&nbsp;&nbsp;\nend&nbsp;write_BmpHeader;\n&nbsp;&nbsp;&nbsp;\n&nbsp;\n&nbsp;&nbsp;&nbsp;\nprocedure&nbsp;PutPixel(\n&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;f&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;Sample&nbsp;:&nbsp;in&nbsp;T_3BYTE)&nbsp;is\nbegin\n&nbsp;&nbsp;&nbsp;&nbsp;write_pix(f,&nbsp;Sample);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\nend&nbsp;PutPixel;\n--------------------------------------------------------------------------------\n--&nbsp;End&nbsp;pack&nbsp;File\n--------------------------------------------------------------------------------\n&nbsp;&nbsp;&nbsp;\nend&nbsp;bmplibpack;\n&nbsp;\n--------------------------------------------------------------------------------\n--&nbsp;Entity&nbsp;declaration\n--------------------------------------------------------------------------------\n&nbsp;\nlibrary&nbsp;ieee;\n&nbsp;&nbsp;&nbsp;use&nbsp;ieee.std_logic_1164.all;\n&nbsp;&nbsp;&nbsp;use&nbsp;ieee.numeric_std.all;\n&nbsp;&nbsp;&nbsp;use&nbsp;std.textio.all&nbsp;;\n&nbsp;&nbsp;&nbsp;use&nbsp;ieee.std_logic_textio.all&nbsp;;\n&nbsp;&nbsp;&nbsp;\nlibrary&nbsp;work;\n&nbsp;&nbsp;&nbsp;use&nbsp;work.bmplibpack.all;\n&nbsp;\nentity&nbsp;write_bmp_file&nbsp;is\ngeneric(\n&nbsp;&nbsp;&nbsp;output_file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;string&nbsp;&nbsp;:=&nbsp;&quot;results/result_&quot;;\n&nbsp;&nbsp;&nbsp;g_num_of_frames&nbsp;&nbsp;&nbsp;:&nbsp;integer&nbsp;:=&nbsp;4;\n&nbsp;&nbsp;&nbsp;VIDEO_WIDTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;natural&nbsp;:=&nbsp;64;\n&nbsp;&nbsp;&nbsp;VIDEO_HEIGHT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;natural&nbsp;:=&nbsp;64;\n&nbsp;&nbsp;&nbsp;NUM_DATA_STREAMS&nbsp;:&nbsp;natural&nbsp;:=&nbsp;1\n&nbsp;&nbsp;&nbsp;);\nport(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_vsync&nbsp;&nbsp;&nbsp;:&nbsp;in&nbsp;&nbsp;&nbsp;std_logic;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_hsync&nbsp;&nbsp;&nbsp;:&nbsp;in&nbsp;&nbsp;&nbsp;std_logic;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_clk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;in&nbsp;&nbsp;&nbsp;std_logic;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_data_en&nbsp;:&nbsp;in&nbsp;&nbsp;&nbsp;std_logic;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in_data&nbsp;&nbsp;:&nbsp;in&nbsp;&nbsp;VideoDataArray(0&nbsp;to&nbsp;NUM_DATA_STREAMS-1)(23&nbsp;downto&nbsp;0)\n&nbsp;&nbsp;&nbsp;);\nend&nbsp;write_bmp_file;\n&nbsp;\n--------------------------------------------------------------------------------\n--&nbsp;Architecture&nbsp;declaration\n--------------------------------------------------------------------------------\n&nbsp;&nbsp;&nbsp;\narchitecture&nbsp;arch_write_bmp_file&nbsp;of&nbsp;write_bmp_file&nbsp;is\nbegin\n&nbsp;&nbsp;&nbsp;&nbsp;process\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file&nbsp;pic_file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_PICFILE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;file_status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;FILE_OPEN_STATUS;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;bmp_record&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;R_bmp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;pixel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;T_3BYTE;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;pixelCount&nbsp;:&nbsp;integer;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variable&nbsp;lineCount&nbsp;:&nbsp;integer;\n&nbsp;&nbsp;&nbsp;&nbsp;begin\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;init&nbsp;file&nbsp;now&nbsp;with&nbsp;fixed&nbsp;zises,&nbsp;but&nbsp;later&nbsp;size&nbsp;can&nbsp;come&nbsp;from&nbsp;generics\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_record.picsize&nbsp;:=&nbsp;(VIDEO_HEIGHT&nbsp;*&nbsp;VIDEO_WIDTH)*3;&nbsp;--&nbsp;3&nbsp;bytes&nbsp;per&nbsp;pixel&nbsp;(RGB)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_record.FileSize&nbsp;:=&nbsp;(VIDEO_HEIGHT&nbsp;*&nbsp;VIDEO_WIDTH)*3&nbsp;+&nbsp;54;&nbsp;&nbsp;--&nbsp;54&nbsp;is&nbsp;the&nbsp;offset\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_record.picwidth&nbsp;:=&nbsp;VIDEO_WIDTH;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bmp_record.picheight&nbsp;:=&nbsp;VIDEO_HEIGHT;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;start&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;0&nbsp;to&nbsp;g_num_of_frames&nbsp;loop&nbsp;&nbsp;--&nbsp;number&nbsp;of&nbsp;frames&nbsp;to&nbsp;collect\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wait&nbsp;until&nbsp;rising_edge(in_vsync);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixelCount&nbsp;:=&nbsp;0;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lineCount&nbsp;:=&nbsp;0;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_OPEN(file_status,&nbsp;pic_file,&nbsp;output_file&nbsp;&amp;&nbsp;integer&apos;image(i)&nbsp;&amp;&nbsp;&quot;.bmp&quot;,&nbsp;WRITE_MODE);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;file_status&nbsp;&nbsp;/=&nbsp;OPEN_OK&nbsp;then&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;report&nbsp;&quot;file&nbsp;could&nbsp;not&nbsp;open&quot;&nbsp;severity&nbsp;failure;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;report&nbsp;&quot;Opening&nbsp;bmp&nbsp;file&nbsp;number&nbsp;&nbsp;&quot;&nbsp;&amp;&nbsp;integer&apos;image(i)&nbsp;&nbsp;severity&nbsp;note;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;write_BmpHeader(pic_file,&nbsp;bmp_record);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(in_vsync&nbsp;=&nbsp;&apos;1&apos;)&nbsp;loop\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wait&nbsp;until&nbsp;rising_edge(in_clk);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(in_hsync&nbsp;=&nbsp;&apos;1&apos;)&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixelCount&nbsp;:=&nbsp;0;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(in_hsync&nbsp;=&nbsp;&apos;1&apos;)&nbsp;loop\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wait&nbsp;until&nbsp;rising_edge(in_clk);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(in_data_en&nbsp;=&nbsp;&apos;1&apos;)&nbsp;then\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;dataStream&nbsp;in&nbsp;0&nbsp;to&nbsp;NUM_DATA_STREAMS-1&nbsp;loop\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixel&nbsp;:=&nbsp;in_data(dataStream);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PutPixel(pic_file,&nbsp;pixel);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixelCount&nbsp;:=&nbsp;pixelCount&nbsp;+&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;loop;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;loop;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Fill&nbsp;missing&nbsp;pixels&nbsp;with&nbsp;red&nbsp;color\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;1&nbsp;to&nbsp;(VIDEO_WIDTH&nbsp;-&nbsp;pixelCount)&nbsp;loop&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixel&nbsp;:=&nbsp;24X&quot;FF0000&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PutPixel(pic_file,&nbsp;pixel);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;loop;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lineCount&nbsp;:=&nbsp;lineCount&nbsp;+&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;if;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;loop;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;Fill&nbsp;missing&nbsp;pixels&nbsp;with&nbsp;red&nbsp;color\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;1&nbsp;to&nbsp;(VIDEO_HEIGHT&nbsp;-&nbsp;lineCount)&nbsp;loop\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;1&nbsp;to&nbsp;VIDEO_WIDTH&nbsp;loop\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixel&nbsp;:=&nbsp;24X&quot;FF0000&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PutPixel(pic_file,&nbsp;pixel);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;loop;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;loop;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_CLOSE(pic_file);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;loop;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wait;\n&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;process;\n&nbsp;\nend&nbsp;arch_write_bmp_file;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;\n--------------------------------------------------------------------------------\n--&nbsp;End&nbsp;File\n--------------------------------------------------------------------------------\n&nbsp;&nbsp;\n';
Report.brushes['./../../../OsvvmLibraries/VideoBus_LouisAdriaens/src/bmp_pack.vhd'] = 'vhdl'
